import {
	BasicInfoRequest,
	BasicInfoResponse,
	fromLockUnoTime,
	IMessage,
	ProtocolV1,
} from '../../src';

export const publicKey = Uint8Array.from([
	220,
	235,
	242,
	94,
	164,
	37,
	128,
	141,
	42,
	122,
	255,
	8,
	143,
	130,
	94,
	153,
	158,
	36,
	41,
	163,
	161,
	16,
	160,
	184,
	20,
	26,
	129,
	203,
	116,
	177,
	18,
	120,
]);

describe('Basic info request', () => {
	test('create request', () => {
		expect(
			new BasicInfoRequest(new ProtocolV1(0, fromLockUnoTime(0))).toBytes()
		).toEqual(Uint8Array.from([131, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0]));
	});
});

describe('Basic info response', () => {
	test.each([
		[
			Uint8Array.from([
				220,
				235,
				242,
				94,
				164,
				37,
				128,
				141,
				42,
				122,
				255,
				8,
				143,
				130,
				94,
				153,
				158,
				36,
				41,
				163,
				161,
				16,
				160,
				184,
				20,
				26,
				129,
				203,
				116,
				177,
				18,
				120,
				159,
				0,
				0,
				0,
				100,
				0,
				0,
				0,
				21,
				0,
				0,
				0,
				8,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				233,
				14,
				0,
				0,
				3,
				0,
				0,
				0,
			]),
			new BasicInfoResponse(
				new ProtocolV1(),
				159,
				100,
				21,
				3,
				8,
				3817,
				publicKey
			),
		],
	])('parse', (data: Uint8Array, message: IMessage) => {
		expect(BasicInfoResponse.parse(message.header.protocol, data)).toEqual(
			message
		);
	});
});
